var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},c=Object.create(new $jscomp.global.Proxy(b,{get:function(d,f,g){return d==b&&"q"==f&&g==c}}));return!0===c.q}catch(d){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(b){var c=0;return function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(b,c){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function b(d){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+c++,d)}var c=0;return b}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};
$jscomp.makeIterator=function(b){var c="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return c?c.call(b):$jscomp.arrayIterator(b)};$jscomp.owns=function(b,c){return Object.prototype.hasOwnProperty.call(b,c)};$jscomp.polyfill=function(b,c,d,f){if(c){d=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var g=b[f];g in d||(d[g]={});d=d[g]}b=b[b.length-1];f=d[b];c=c(f);c!=f&&null!=c&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(b){function c(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),e=Object.seal({}),c=new b([[a,2],[e,3]]);if(2!=c.get(a)||3!=c.get(e))return!1;c.delete(a);c.set(e,4);return!c.has(a)&&4==c.get(e)}catch(n){return!1}}function d(){}function f(a){var e=typeof a;return"object"===e&&null!==a||"function"===e}function g(a){if(!$jscomp.owns(a,h)){var e=new d;$jscomp.defineProperty(a,h,{value:e})}}function k(a){var e=Object[a];e&&(Object[a]=function(a){if(a instanceof
d)return a;g(a);return e(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(c())return b;var h="$jscomp_hidden_"+Math.random();k("freeze");k("preventExtensions");k("seal");var m=0,a=function(a){this.id_=(m+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)e=e.value,this.set(e[0],e[1])}};a.prototype.set=function(a,e){if(!f(a))throw Error("Invalid WeakMap key");g(a);if(!$jscomp.owns(a,h))throw Error("WeakMap key fail: "+
a);a[h][this.id_]=e;return this};a.prototype.get=function(a){return f(a)&&$jscomp.owns(a,h)?a[h][this.id_]:void 0};a.prototype.has=function(a){return f(a)&&$jscomp.owns(a,h)&&$jscomp.owns(a[h],this.id_)};a.prototype.delete=function(a){return f(a)&&$jscomp.owns(a,h)&&$jscomp.owns(a[h],this.id_)?delete a[h][this.id_]:!1};return a},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var e=c.entries(),d=e.next();if(d.done||d.value[0]!=a||"s"!=d.value[1])return!1;d=e.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!e.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(c())return b;$jscomp.initSymbolIterator();var d=new WeakMap,f=function(a){this.data_={};this.head_=h();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};f.prototype.set=function(a,b){a=0===a?0:a;var e=g(this,a);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=b:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};f.prototype.delete=function(a){a=g(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};f.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=h();this.size=0};f.prototype.has=function(a){return!!g(this,a).entry};
f.prototype.get=function(a){return(a=g(this,a).entry)&&a.value};f.prototype.entries=function(){return k(this,function(a){return[a.key,a.value]})};f.prototype.keys=function(){return k(this,function(a){return a.key})};f.prototype.values=function(){return k(this,function(a){return a.value})};f.prototype.forEach=function(a,b){for(var e=this.entries(),c;!(c=e.next()).done;)c=c.value,a.call(b,c[1],c[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var g=function(a,b){var e=b&&typeof b;"object"==
e||"function"==e?d.has(b)?e=d.get(b):(e=""+ ++m,d.set(b,e)):e="p_"+b;var c=a.data_[e];if(c&&$jscomp.owns(a.data_,e))for(a=0;a<c.length;a++){var f=c[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:e,list:c,index:a,entry:f}}return{id:e,list:c,index:-1,entry:void 0}},k=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},h=function(){var a={};return a.previous=
a.next=a.head=a},m=0;return f},"es6","es3");
var Common=function(){var b="B KB MB GB TB PB EB ZB YB".split(" ");return{renderSize:function(c){if(null==c||""==c)return"0 Bytes";var d=parseFloat(c);c=Math.floor(Math.log(d)/Math.log(1024));d/=Math.pow(1024,c);d=d.toFixed(2);return d+b[c]},removePostfix:function(b){var c=b.lastIndexOf(".");0<c&&(b=b.substring(0,c));return b},initTooltip:function(){$('[data-toggle="tooltip"]').tooltip()},writeCookie:function(b,d){$.cookie(b,d,{expires:9999})},cookieIfPresent:function(b,d){(b=$.cookie(b))&&d(b)},
render:function(b,d){b.content||(b.content=$(b.name).html().trim(),Mustache.parse(b.content));return Mustache.render(b.content,d)},ts:function(){return Math.round((new Date).getTime()/1E3).toString()}}}();$(function(){$.cookie.json=!0;toastr.options.closeButton=!0;Common.initTooltip()});
var ChatServerArray=[{name:"bilibili",value:"chat.bilibili.com"},{name:"\u4f18\u9177",value:"service.danmu.youku.com"},{name:"\u7231\u5947\u827a",value:"cmts.iqiyi.com"},{name:"\u817e\u8baf",value:"mfm.video.qq.com"},{name:"\u7b2c\u4e00\u5f39",value:"api.diyidan.net"},{name:"\u52a8\u753b\u75af",value:"ani.gamer.com.tw"},{name:"AcFun",value:"danmu.aixifan.com"},{name:"\u641c\u72d0",value:"api.danmu.tv.sohu.com"}],Server=function(){var b;return{list:["dmrepository/list"],getKey:function(){b||(b=CryptoJS.enc.Utf8.parse("HW18mCuEW72sjQoRm5OREM7S3qy3ZBgFV8EqPAP6jsZJLpfaglQ9rNwmhlC7k"));
return b}}}(),Searcher=function(){function b(a){a=CryptoJS.AES.decrypt(a,Server.getKey(),{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return CryptoJS.enc.Utf8.stringify(a).toString()}function c(a,b,c){var e=new Map;Server.list.forEach(function(f,g){var l=f.indexOf("/"),k=f.substring(0,l),p=f.substring(l+1);h.has(f)?(l=h.get(f),e.set(f,l.size),d(f,k,p,g+1,e,l,a,b,c)):$.ajax({url:"https://"+k+".github.io/"+p+"/index"}).done(function(l){l=l.split(",");var n=new Map;l.forEach(function(a){return n.set(a,
void 0)});h.set(f,n);e.set(f,n.size);d(f,k,p,g+1,e,n,a,b,c)}).fail(function(a){toastr.error("\u8bf7\u6c42\u5f39\u5e55\u670d\u52a1\u5668\uff1a"+f+" \u65f6\uff0c\u53d1\u751f\u9519\u8bef\uff01");console.error(a)})})}function d(c,d,g,h,m,t,l,q,u){var e=0;t.forEach(function(n,p){n?(k(l,d,p,n,q),f(c,h,m,++e,l,u)):$.ajax({url:"https://"+d+".github.io/"+g+"/"+p}).done(function(c){c=b(c).split(";").map(function(a){return a.split(",")});a+=c.length;q(void 0,a);r+=c.map(function(a){return parseFloat(a[1])}).reduce(function(a,
b){return a+b});t.set(p,c);k(l,d,p,c,q)}).fail(function(a){toastr.error("\u8bf7\u6c42\u5f39\u5e55\u4ed3\u5e93\uff1a"+repo+" \u65f6\uff0c\u53d1\u751f\u9519\u8bef\uff01");console.error(a)}).always(function(){f(c,h,m,++e,l,u)})})}function f(a,b,c,d,f,g){c.get(a)==d&&c.delete(a);b==Server.list.length&&0==c.size&&g(f,r)}function g(a){var b="\u672a\u77e5";a<ChatServerArray.length&&(b=ChatServerArray[a].name);return b}function k(a,b,c,d,f){var e=[];d.forEach(function(d){var f=d[0];if(-1<f.toLowerCase().indexOf(a)){var h=
"https://cdn.jsdelivr.net/gh/"+b+"/"+c+"/"+d[3]+".7z";e.push({name:f,from:g(d[2]),length:d[1],operate:m,url:h})}});0<e.length&&f(e)}var h=new Map,m=$("#button-download").html().trim(),a=0,r=0;return{search:function(a,b,d){c(a,b,d)}}}();
$(function(){function b(a,b){void 0==a?d.text("\u5df2\u6536\u5f55\u5f39\u5e55\uff1a"+b.toLocaleString()):(a.forEach(function(a){0==a.name.indexOf("[\u5f39\u5e55\u5305]")&&$("#danmu-pkg").removeClass("d-none")}),g.bootstrapTable("append",a),g.bootstrapTable("hideLoading"))}function c(a,b){0==g.bootstrapTable("getData").length&&$("tr.no-records-found td").text('\u672a\u627e\u5230\u5305\u542b "'+a+'" \u7684\u76f8\u5173\u7ed3\u679c\u3002');void 0==d.attr("title")&&(a=Common.renderSize(b),d.attr("title",
"\u5408\u8ba1\uff1a"+a),d.attr("data-toggle","tooltip"),d.attr("data-placement","top"),d.tooltip());g.bootstrapTable("hideLoading");h.attr("disabled",!1)}var d=$("#danmuku-number"),f=$("#txt-keyword"),g=$("#table"),k=$("#ckb-copy"),h=$("#main-form"),m=$("#btn-search");Common.cookieIfPresent("search",function(a){k.attr("checked",a.downloadCopy)});k.change(function(){var a=k.is(":checked");Common.writeCookie("search",{downloadCopy:a})});f.bind("input propertychange",function(){var a=0==f.val().trim();
m.attr("disabled",a)});m.click(function(){g.bootstrapTable("removeAll");var a=f.val().trim();0<a.length&&(h.attr("disabled",!0),g.bootstrapTable("showLoading"),Searcher.search(a.toLowerCase(),b,c))});g.bootstrapTable("refreshOptions",{locale:"zh-CN"})});
